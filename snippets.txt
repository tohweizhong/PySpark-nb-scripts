Count number of unique values in a data frame column:
s_df.select('k').distinct().rdd.map(lambda r: r[0]).collect()

For a dataframe df:
df.select() returns a dataframe of one column
df.<colname> returns a Column

Use this to change python version for pyspark apps:
os.environ['PYSPARK_PYTHON'] = 'C:\Users\Wei Zhong\Anaconda3\envs\python2\python' # <--- use this to change python version

StructField

- saveAsTextFile returns a directory

type colnames

Write pyspark dataframe to file
df.rdd.map(lambda x: ",".join(map(str, x))).coalesce(1).saveAsTextFile("file.csv")
